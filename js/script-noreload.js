function ajaxRelated(e,t,a,r,s){if(s.match("getrelated"))return getAjax(e,t,a,r)}function ajaxFeatured(e,t,a,r,s,n){if(s.match("getfeatured")){if("featured"==t)return getAjax(e,t,a,r,n);e.html(beforeLoader()).parent().addClass("show-ify"),setTimeout(function(){e.html(msgError())},500)}}function getAjax(u,f,e,a,r){switch(f){case"featured":case"related":null==a&&(a="geterror404");var t=getFeedUrl(f,e,a);$.ajax({url:t,type:"GET",dataType:"json",cache:!0,beforeSend:function(e){var t=getCustomStyle(f,a,r);switch(f){case"featured":$("#page-skin-2").prepend(t),u.html(beforeLoader()).parent().addClass("id-"+f+"-"+a+" show-ify");break;case"related":u.html(beforeLoader()).parent().addClass("show-ify")}},success:function(e){var t="";switch(f){case"featured":t='<div class="featured-posts">';break;case"related":t='<div class="related-posts">'}var a=e.feed.entry;if(null!=a)for(var r=0,s=a;r<s.length;r++){var n=getPostLink(s,r),o=getPostTitle(s,r,n),i=getPostImage(s,r,n),l=getPostMeta(getPostAuthor(s,r),getPostDate(s,r)),d=getPostLabel(s,r),c="";switch(f){case"featured":switch(r){case 0:c+='<article class="featured-item post item-'+r+'"><div class="featured-item-inner"><a class="entry-image-link before-mask" href="'+n+'"><span class="entry-thumb" id="thumb-image" data-image="'+i+'"/></a>'+d+'<div class="entry-header entry-info"><h2 class="entry-title"><a href="'+n+'">'+o+"</a></h2>"+l[0]+'</div></div></article><div class="featured-scroll">';break;default:c+='<article class="featured-item post item-'+r+'"><div class="featured-item-inner"><a class="entry-image-link before-mask" href="'+n+'"><span class="entry-thumb" id="thumb-image" data-image="'+i+'"/></a>'+d+'<div class="entry-header entry-info"><h2 class="entry-title"><a href="'+n+'">'+o+"</a></h2>"+l[1]+"</div></div></article>"}break;case"related":c+='<article class="related-item post item-'+r+'"><div class="entry-image"><a class="entry-image-link" href="'+n+'"><span class="entry-thumb" id="thumb-image" data-image="'+i+'"/></a></div><div class="entry-header"><h2 class="entry-title"><a href="'+n+'">'+o+"</a></h2>"+l[1]+"</div></article>"}t+=c}else t=msgError();switch(f){case"featured":t+="</div></div>",u.html(t);break;default:t+="</div>",u.html(t)}u.find("span.entry-thumb").lazyify()},error:function(){u.html(msgServerError())}})}}function regxify(e){return String(e.match(/[^{\}]+(?=})/g)).trim()}function msgError(){return'<span class="no-posts">No Results Found</span>'}function msgServerError(){return'<div class="no-posts error-503"><b>Server encountered an error.</b> Check your connection and try again.</div>'}function beforeLoader(){return'<div class="loader"/>'}function getFeedUrl(e,t,a){var r="";switch(a){case"recent":r="/feeds/posts/default?alt=json&max-results="+t;break;case"comments":r="list"==e?"/feeds/comments/default?alt=json&max-results="+t:"/feeds/posts/default/-/"+a+"?alt=json&max-results="+t;break;default:r="/feeds/posts/default/-/"+a+"?alt=json&max-results="+t}return r}function getPostLink(e,t){for(var a=0;a<e[t].link.length;a++)if("alternate"==e[t].link[a].rel){var r=e[t].link[a].href;break}return r}function getPostTitle(e,t){return e[t].title.$t}function getFirstImage(e,t){var a=$("<div>").html(e).find("img:first").attr("src"),r=a.lastIndexOf("/")||0,s=a.lastIndexOf("/",r-1)||0,n=a.substring(0,s),o=a.substring(s,r),i=a.substring(r);return(o.match(/\/s[0-9]+/g)||o.match(/\/w[0-9]+/g)||"/d"==o)&&(o="/w72-h72-p-k-no-nu"),n+o+i}function getPostImage(e,t,a){var r=e[t].content.$t,s=e[t].media$thumbnail?e[t].media$thumbnail.url:"https://assets.perpetualtoday.now.sh/images/default_article_image.jpg";return-1<r.indexOf(r.match(/<iframe(?:.+)?src=(?:.+)?(?:www.youtube.com)/g))?!(-1<r.indexOf("<img"))||r.indexOf(r.match(/<iframe(?:.+)?src=(?:.+)?(?:www.youtube.com)/g))<r.indexOf("<img")?s.replace("/default.","/0."):getFirstImage(r):-1<r.indexOf("<img")?getFirstImage(r):"https://assets.perpetualtoday.now.sh/images/default_article_image.jpg"}function getPostAuthor(e,t){var a=e[t].author[0].name.$t;return"true"==messages.postAuthor?'<span class="entry-author">'+a+"</span>":""}function getPostDate(e,t){var a=e[t].published.$t,r=a.substring(0,4),s=a.substring(5,7),n=a.substring(8,10),o=monthFormat[parseInt(s,10)-1]+" "+n+", "+r,i="true"==messages.postDate?'<span class="entry-time"><time class="published" datetime="'+a+'">'+o+"</time></span>":"";return i}function getPostMeta(e,t){var a="true"==messages.postAuthor||"true"==messages.postDate?'<div class="entry-meta">'+e+t+"</div>":"",r="true"==messages.postDate?'<div class="entry-meta">'+t+"</div>":"";return[a,r]}function getPostLabel(e,t){var a=null!=e[t].category?'<span class="entry-category">'+e[t].category[0].term+"</span>":"";return a}function getCustomStyle(e,t,a){var r;return""!=a?"featured"==e&&(r=".id-"+e+"-"+t+" .entry-category{background-color:"+a+";color:#fff}.id-"+e+"-"+t+" .loader:after{border-color:"+a+";border-right-color:rgba(155,155,155,0.2)}"):r="",r}$("#onepress-free-main-menu").menuify(),$("#onepress-free-main-menu .widget").addClass("show-menu"),$(".search-toggle").on("click",function(){$("body").toggleClass("search-active")}),$(function(){$(".mobile-logo").each(function(){var e=$(this),t=$("#main-logo .header-widget a").clone();t.find("#h1-tag").remove(),t.appendTo(e)}),$("#onepress-free-mobile-menu").each(function(){var e=$(this),t=$("#onepress-free-main-menu-nav").clone();t.attr("id","main-mobile-nav"),t.appendTo(e),$(".show-onepress-free-mobile-menu, .hide-onepress-free-mobile-menu, .overlay").on("click",function(){$("body").toggleClass("nav-active")}),$(".onepress-free-mobile-menu .has-sub").append('<div class="submenu-toggle"/>')}),$("#main-wrapper,#sidebar-wrapper").each(function(){var e;1==fixedSidebar&&(e=1==fixedMenu?90:30,$(this).theiaStickySidebar({additionalMarginTop:e,additionalMarginBottom:30}))}),$("#onepress-free-header-wrapper .headerify").each(function(){var t,e,a,r,s=$(this);1==fixedMenu&&0<s.length&&(t=$(document).scrollTop(),e=s.offset().top,a=s.height(),r=e+a,$(window).scroll(function(){var e=$(document).scrollTop();e<$("#footer-wrapper").offset().top-a&&(r<e?s.addClass("is-fixed"):e<=0&&s.removeClass("is-fixed"),t<e?s.removeClass("show"):s.addClass("show"),t=$(document).scrollTop())}))}),$(".back-top").each(function(){var e=$(this);$(window).on("scroll",function(){100<=$(this).scrollTop()?e.fadeIn(250):e.fadeOut(250),e.offset().top>=$("#footer-wrapper").offset().top-32?e.addClass("on-footer"):e.removeClass("on-footer")}),e.click(function(){$("html, body").animate({scrollTop:0},500)})})});